{"version":3,"sources":["script.js"],"names":["replyToDelete","modal","document","querySelector","overlay","body","commentsCtn","userImgEl","heights","generateUniqueId","Date","now","toString","Math","random","substring","openModal","element","classList","add","style","display","addEventListener","closeModal","remove","setTimeout","commentData","JSON","parse","localStorage","getItem","currentUser","updatelocalstorage","setItem","stringify","setCurrentUser","src","image","webp","length","fetch","then","res","json","data","renderComments","err","console","log","comments","innerHTML","forEach","comment","i","content","createdAt","replies","score","upvoted","downvoted","user","username","concat","renderReplies","getSpaceBetweenElements","isDate","value","date","getTime","commentIndex","html","reply","id","replyingTo","formatDate","element1","element2","spaceBetweenElements","lines","Array","from","querySelectorAll","getElementById","parentElement","nextElementSibling","offsetTop","offsetHeight","push","height","increaseScore","find","textContent","decreaseScore","previousElementSibling","increaseReplyScore","replyIndex","thisReplies","indexOf","decreaseReplyScore","window","replyToUpdate","inputValue","isOnReply","commentCard","closest","index","children","lastChild","lastElementChild","getAttribute","insertAdjacentHTML","textArea","focus","selectionStart","selectionEnd","setAttribute","locale","arguments","undefined","navigator","language","calcDaysPassed","date1","date2","round","abs","daysPassed","Intl","DateTimeFormat","format","preRenderReply","commentToInsertIn","trim","replace","png","editReply","commentSection","validateInput","input","btn","disabled","updateReply","deleteReply","findIndex","splice"],"mappings":"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","file":"script.js","sourcesContent":["const modal = document.querySelector(\".modal\");\r\nconst overlay = document.querySelector(\".overlay\");\r\nconst body = document.querySelector(\"body\");\r\nconst commentsCtn = document.querySelector(\".allCommentCtn\");\r\nconst userImgEl = document.querySelector(\"#currentUserImg\");\r\nlet heights = []\r\nlet replyToDelete;\r\n\r\n\r\nconst generateUniqueId = () => {\r\n  return Date.now().toString(36) + Math.random().toString(36).substring(2, 5);\r\n}\r\n\r\nconst openModal = (element) => {\r\n  modal.classList.add(\"fade-in\");\r\n  overlay.classList.add(\"fade-in\");\r\n  modal.style.display = \"block\"; // make the modal visible\r\n  overlay.style.display = \"block\"; // make the overlay visible\r\n  body.classList.add(\"no-scroll\");\r\n\r\n  overlay.addEventListener(\"click\", closeModal);\r\n};\r\n\r\nconst closeModal = () => {\r\n  modal.classList.add(\"fade-out\");\r\n  overlay.classList.add(\"fade-out\");\r\n  body.classList.remove(\"no-scroll\");\r\n\r\n  setTimeout(() => {\r\n    modal.style.display = \"none\"; // hide the modal after the animation completes\r\n    overlay.style.display = \"none\"; // hide the overlay after the animation completes\r\n    modal.classList.remove(\"fade-out\");\r\n    overlay.classList.remove(\"fade-out\");\r\n  }, 300); // set the timeout to match the animation duration\r\n};\r\n\r\nlet commentData = JSON.parse(localStorage.getItem(\"commentData\")) || [];\r\nlet currentUser = {};\r\n\r\nconst updatelocalstorage = () => {\r\n  localStorage.setItem(\"commentData\", JSON.stringify(commentData));\r\n  commentData = JSON.parse(localStorage.getItem(\"commentData\"))\r\n}\r\n\r\nconst setCurrentUser = () => {\r\n  currentUser = commentData.currentUser;\r\n  userImgEl.src = currentUser.image.webp;\r\n};\r\n\r\nif (commentData.length === 0) {\r\n  fetch(\"./data.json\")\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n      commentData = data;\r\n      localStorage.setItem(\"commentData\", JSON.stringify(commentData));\r\n      setTimeout(() => {\r\n        setCurrentUser();\r\n        renderComments();\r\n      });\r\n    })\r\n    .catch((err) => console.log(\"something went wrong\", err));\r\n} else {\r\n  setTimeout(() => {\r\n    setCurrentUser();\r\n    console.log(commentData.comments);\r\n    renderComments();\r\n  });\r\n}\r\n\r\n// ! RENDER COMMENTS FUNCTION\r\nconst renderComments = () => {\r\n  console.log(\"renderComments function called\");\r\n\r\n  commentsCtn.innerHTML = \"\";\r\n\r\n  commentData.comments.forEach((comment, i) => {\r\n    const { content, createdAt, replies, score, upvoted, downvoted, user } = comment;\r\n\r\n      if (user.username !== currentUser.username) {\r\n        commentsCtn.innerHTML += /*html*/ `\r\n        \r\n        <section class=\"commentSection overflow-hidden\">\r\n           <div id=\"${i}\" class=\"commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4\">\r\n               <div class=\"commentCard__header flex items-center gap-x-4 pb-4\">\r\n                   <img class=\"w-10\" src=\"${\r\n                     user.image.webp\r\n                   }\" alt=\"profile img avatar\">\r\n                   <p class=\"username font-semibold\">${user.username}</p>\r\n                   <p class=\"postedAt font-medium\">${createdAt}</p>\r\n               </div>\r\n               <p class=\"commentCard__comment\">\r\n                   ${content}\r\n               </p>\r\n               <div class=\"commentCard__footer flex items-center justify-between mt-5 lg:block\">\r\n                   <div class=\"score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3\">\r\n                   <i onclick=\"increaseScore(${i}, this, ${upvoted})\" class=\"bi bi-plus\"></i>\r\n                   <span class=\"count\">${score}</span>\r\n                   <i onclick=\"decreaseScore(${i}, this, ${downvoted})\" class=\"bi bi-dash\"></i>\r\n                   </div>\r\n                   <div data-clicked=\"false\" onclick=\"reply(this, ${i}, false, '${user.username}')\" class=\"replyBtn flex items-center gap-x-1 font-medium lg:absolute top-7 right-10 cursor-pointer\">\r\n                   <i class=\"bi bi-reply-fill\"></i>\r\n                   <p>Reply</p>\r\n                   </div>\r\n               </div>\r\n           </div>\r\n   \r\n           ${renderReplies(replies, i)}\r\n   \r\n      </section>\r\n   \r\n        `;\r\n      } else {\r\n          commentsCtn.innerHTML += /*html*/ `\r\n          <section class=\"commentSection\">\r\n          \r\n          <div id=\"${i}\" class=\"commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 mt-5 ml-auto w-[95%] lg:w-[88%]\">\r\n              <div class=\"commentCard__header flex items-center gap-x-4 pb-4\">\r\n                  <img class=\"w-10\" src=\"${user.image.webp}\" alt=\"user profile avatar\">\r\n                  <p class=\"username font-semibold\">${user.username}</p>\r\n                  <p class=\"you text-white px-2 ml-[-10px] text-sm\">you</p>\r\n                  <p class=\"postedAt font-medium\">${createdAt}</p>\r\n              </div>\r\n          <p class=\"commentCard__comment\">\r\n            ${content}\r\n          </p>\r\n          <div class=\"commentCard__footer flex items-center justify-between mt-5 lg:block\">\r\n          <div class=\"score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3\">\r\n              <i onclick=\"increaseScore(${i}, this, ${upvoted})\" class=\"bi bi-plus\"></i>\r\n              <span class=\"count\">${score}</span>\r\n              <i onclick=\"decreaseScore(${i}, this, ${downvoted})\" class=\"bi bi-dash\"></i>\r\n          </div>\r\n          <div class=\"crudBtns flex items-center gap-x-3 lg:gap-x-5 font-medium lg:absolute top-7 right-10\">\r\n              <div onclick=\"openModal(this)\" class=\"delete flex items-center gap-x-1 text-red-500 cursor-pointer\">\r\n              <i class=\"bi bi-trash-fill\"></i>\r\n              <p>DELETE</p>\r\n              </div>\r\n              <div onclick=\"editComment(this, ${i}, ${score})\" class=\"edit flex items-center gap-x-1 cursor-pointer\">\r\n              <i class=\"bi bi-pen-fill\"></i>\r\n              <p>EDIT</p>\r\n              </div>\r\n          </div>\r\n          </div>\r\n      </div>\r\n\r\n        ${renderReplies(replies, i)}\r\n    </section>\r\n        `;\r\n     }\r\n  })\r\n\r\n\r\n  commentData.comments.forEach((comment, i) => {\r\n    const { replies } = comment\r\n    if (replies.length > 0) {\r\n      getSpaceBetweenElements(i)\r\n      heights = []\r\n    }\r\n  })\r\n};\r\n\r\n// ! DATE FORMAT CHECKER\r\nconst isDate = (value) => {\r\n  const date = new Date(value);\r\n  return date.getTime() === date.getTime(); // Check if getTime() returns a valid timestamp\r\n}\r\n\r\n// ! REPLY RENDERING FUNCTION \r\nconst renderReplies = (data, commentIndex) => {\r\n  console.log(\"render replies function called\");\r\n  let html = \"\";\r\n  if (data.length > 0) {\r\n\r\n    data.forEach((reply, i) => {\r\n      const { id, content, createdAt, replyingTo, score, upvoted, downvoted, user } = reply;\r\n\r\n        if (user.username !== currentUser.username) {\r\n            html += /*html*/ `\r\n            <section class=\"replySection\">\r\n            \r\n            <div class=\"replyCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 w-[95%] lg:w-[88%]\">\r\n                    ${\r\n                      i === 0\r\n                        ? /*html*/ `\r\n                    <span id=\"line\" class=\"block line absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300\"></span>\r\n                    `\r\n                        : \"\"\r\n                    }\r\n                    <div class=\"replyCard__header flex items-center gap-x-4 pb-4\">\r\n                        <img class=\"w-10\" src=\"${user.image.webp}\" alt=\"\">\r\n                        <p class=\"username font-semibold\">${user.username}</p>\r\n                        <p class=\"postedAt font-medium\">${isDate(createdAt) ? formatDate(createdAt) : createdAt}</p>\r\n                    </div>\r\n                    <p class=\"replyCard__comment\">\r\n                     <span class=\"replyTo font-bold pr-1\">@${replyingTo}</span>${content}\r\n                    </p>\r\n                    <div class=\"replyCard__footer flex items-center justify-between mt-5 lg:block\">\r\n                        <div class=\"score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3\">\r\n                            <i onclick=\"increaseReplyScore(${i}, '${commentIndex}', this, ${upvoted})\" class=\"bi bi-plus\"></i>\r\n                            <span class=\"count\">${score}</span>\r\n                            <i onclick=\"decreaseReplyScore(${i}, '${commentIndex}', this, ${downvoted})\" class=\"bi bi-dash\"></i>\r\n                        </div>\r\n                    <div data-clicked=\"false\" onclick=\"reply(this, ${commentIndex}, true, '${user.username}')\" class=\"replyBtn flex items-center gap-x-1 font-medium lg:absolute top-7 right-10 cursor-pointer\">\r\n                        <i class=\"bi bi-reply-fill\"></i>\r\n                        <p>Reply</p>\r\n                    </div>\r\n                  </div>\r\n           </div>\r\n\r\n            </section>\r\n            `;\r\n        } else {\r\n            html += /*html*/ `\r\n            <div class=\"commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 mt-5 ml-auto w-[95%] lg:w-[88%]\">\r\n            ${\r\n                i === 0\r\n                  ? /*html*/ `\r\n              <span id=\"line\" class=\"block line absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300\"></span>\r\n              `\r\n                  : \"\"\r\n              }\r\n                <div class=\"commentCard__header flex items-center gap-x-4 pb-4\">\r\n                    <img class=\"w-10\" src=\"${user.image.webp}\" alt=\"user profile avatar\">\r\n                    <p class=\"username font-semibold\">${user.username}</p>\r\n                    <p class=\"you text-white px-2 ml-[-10px] text-sm\">you</p>\r\n                    <p class=\"postedAt font-medium\">${createdAt}</p>\r\n                </div>\r\n                <p class=\"commentCard__comment\">\r\n                <span class=\"replyTo font-bold pr-1\">@${replyingTo}</span>${content}\r\n                </p>\r\n                <div class=\"commentCard__footer flex items-center justify-between mt-5 lg:block\">\r\n                <div class=\"score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3\">\r\n                    <i onclick=\"increaseReplyScore(${i}, '${commentIndex}', this, ${upvoted})\" class=\"bi bi-plus\"></i>\r\n                    <span class=\"count\">${score}</span>\r\n                    <i  onclick=\"decreaseReplyScore(${i}, '${commentIndex}', this, ${downvoted})\" class=\"bi bi-dash\"></i>\r\n                </div>\r\n                <div class=\"crudBtns flex items-center gap-x-3 lg:gap-x-5 font-medium lg:absolute top-7 right-10\">\r\n                    <div onclick=\"deleteReply(this, ${commentIndex}, ${i}, '${id}')\" class=\"delete flex items-center gap-x-1 text-red-500 cursor-pointer\">\r\n                        <i class=\"bi bi-trash-fill\"></i>\r\n                        <p>DELETE</p>\r\n                    </div>\r\n                    <div onclick=\"editReply(this, ${commentIndex}, ${i}, ${score}, '${isDate(createdAt) ? formatDate(createdAt) : createdAt}', '${replyingTo}')\" class=\"edit flex items-center gap-x-1 cursor-pointer\">\r\n                        <i class=\"bi bi-pen-fill\"></i>\r\n                        <p>EDIT</p>\r\n                    </div>\r\n                </div>\r\n                </div>\r\n          </div>\r\n            `\r\n     }\r\n    });\r\n  }\r\n\r\n  return html;\r\n};\r\n\r\n\r\n\r\nconst getSpaceBetweenElements = (commentIndex) => {\r\n    console.log(\"getSpaceBetweenElements function called\");\r\n    let element1;\r\n    let element2;\r\n    let spaceBetweenElements;\r\n    let length = commentData.comments.length\r\n\r\n    setTimeout(() => {\r\n        commentData.comments.forEach((comment, i) => {\r\n          const { replies } = comment\r\n          if (replies.length == 0) {\r\n            length--\r\n          }\r\n        })\r\n        console.log(length)\r\n        const lines = Array.from(document.querySelectorAll('.line'))\r\n        element1 = document.getElementById(`${commentIndex}`);\r\n        if (commentIndex !== commentData.comments.length - 1) {\r\n          element2 = element1.parentElement.nextElementSibling\r\n        } else {\r\n          element2 = document.querySelector(\".addComment\");\r\n        }\r\n        spaceBetweenElements = element2.offsetTop - (element1.offsetTop + element1.offsetHeight)\r\n        heights.push(spaceBetweenElements)\r\n        console.log(heights)\r\n        for (let i = 0; i < length; i++) {\r\n          lines[i].style.height = `${heights[i]}px`;\r\n        }\r\n    });\r\n}\r\n\r\n\r\n\r\nconst increaseScore = (commentIndex, element, upvoted) => {\r\n    const comment = commentData.comments.find(comment => comment.id === commentIndex + 1)\r\n    comment.upvoted = true;\r\n    !upvoted && comment.score++\r\n    comment.downvoted = false;\r\n    element.nextElementSibling.textContent = comment.score;\r\n    updatelocalstorage()\r\n    heights = []\r\n    !upvoted && renderComments()\r\n}\r\n\r\n\r\nconst decreaseScore = (commentIndex, element, downvoted) => {\r\n    const comment = commentData.comments.find(comment => comment.id === commentIndex + 1)\r\n    comment.downvoted = true;\r\n    if (!downvoted && comment.score > 0) {\r\n      comment.score--\r\n    }\r\n    comment.upvoted = false; \r\n    element.previousElementSibling.textContent = comment.score;\r\n    updatelocalstorage();\r\n    heights = []\r\n    !downvoted && renderComments()\r\n}\r\n\r\nconst increaseReplyScore = (replyIndex, commentIndex, element, upvoted) => {\r\n    const thisReplies = commentData.comments[commentIndex].replies;\r\n    const reply = thisReplies.find(reply => thisReplies.indexOf(reply) === replyIndex)\r\n    reply.upvoted = true\r\n    !upvoted && reply.score++;\r\n    reply.downvoted = false\r\n    element.nextElementSibling.textContent = reply.score;\r\n    updatelocalstorage()\r\n    heights = []\r\n    !upvoted && renderComments()\r\n}\r\n\r\nconst decreaseReplyScore = (replyIndex, commentIndex, element, downvoted) => {\r\n    const thisReplies = commentData.comments[commentIndex].replies;\r\n    const reply = thisReplies.find(reply => thisReplies.indexOf(reply) === replyIndex)\r\n    reply.downvoted = true\r\n    if (!downvoted && reply.score > 0) {\r\n      reply.score--\r\n    }\r\n    reply.upvoted = false;\r\n    element.previousElementSibling.textContent = reply.score;\r\n    updatelocalstorage()\r\n    heights = []\r\n    !downvoted && renderComments()\r\n}\r\n\r\nwindow.addEventListener('resize', () => {\r\n  commentData.comments.forEach((comment, i) => {\r\n    heights = []\r\n    const { replies } = comment\r\n    if (replies.length > 0) {\r\n      getSpaceBetweenElements(i)\r\n    }\r\n  })\r\n})\r\n\r\n\r\nconst reply = (element, commentIndex, isOnReply, replyingTo) => {\r\n  let commentCard;\r\n  heights = []\r\n\r\n    if (!isOnReply) {\r\n        commentCard =  element.closest(\".commentSection\");\r\n    } else {\r\n        commentCard = element.closest(\".replySection\");\r\n    }\r\n    \r\n    const commentCardChildren = Array.from(commentCard.children);\r\n    const index  = commentCardChildren.length - 1;\r\n    \r\n\r\n    let html = /*html*/ `\r\n    <div class=\"addCommentCard bg-white px-5 lg:pr-4 rounded-xl flex flex-col lg:justify-end lg:flex-row gap-x-5 relative lg:pb-6 lg:pt-4 w-[95%] ml-auto lg:w-[88%] mt-5\">\r\n        ${\r\n          index === 0\r\n            ? /*html*/ `\r\n        <span id=\"line\" class=\"block line absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300\"></span>\r\n        `\r\n            : \"\"\r\n        }\r\n        <textarea name=\"comment\" id=\"${isOnReply ? 'replyInput' : 'replyToCommentInput'}\" cols=\"30\" rows=\"3\" class=\"textArea w-full px-4 py-1 mt-5 lg:mt-4 rounded-lg lg:w-[70%]\" placeholder=\"Add a comment...\">@${replyingTo + ''} </textarea>\r\n        <div class=\"footer flex justify-between items-center lg:block py-3\">\r\n        <img class=\"w-10 lg:absolute left-5 top-8\" src=\"${currentUser.image.webp}\" alt=\"\">\r\n        <button onclick=\"preRenderReply(this, '${replyingTo}', ${isOnReply})\" type=\"button\" class=\"px-7 py-3 lg:py-2 lg:mt-1 text-white rounded-lg font-medium\">REPLY</button>\r\n        </div>\r\n    </div>\r\n    `\r\n    \r\n   const lastChild = commentCard.lastElementChild;\r\n     \r\n   const replyBtnClicked = element.getAttribute(\"data-clicked\");\r\n\r\n  if (replyBtnClicked == 'false') {\r\n     lastChild.insertAdjacentHTML(\"afterend\", html);\r\n     commentData.comments.forEach((comment, i) => {\r\n      const { replies } = comment\r\n      if (replies.length > 0) {\r\n        getSpaceBetweenElements(i)\r\n      }\r\n    })\r\n     const textArea = document.getElementById(`${isOnReply? 'replyInput' : 'replyToCommentInput'}`)\r\n     textArea.focus();\r\n     textArea.selectionStart = replyingTo.length + 2;\r\n     textArea.selectionEnd = replyingTo.length + 2;\r\n   }\r\n\r\n   element.setAttribute(\"data-clicked\", \"true\");\r\n}\r\n\r\n\r\nconst formatDate = (date, locale = navigator.language) => {\r\n  const calcDaysPassed = (date1, date2) => Math.round(Math.abs(date2 - date1) / (1000 * 60 * 60 * 24))\r\n\r\n  const daysPassed = calcDaysPassed(new Date(), date)\r\n  switch (daysPassed) {\r\n    case 0:\r\n      return 'Today';\r\n    case 1:\r\n      return 'Yesterday';\r\n    case daysPassed <= 7:\r\n      return '1 week ago';\r\n    case daysPassed <= 14:\r\n      return '2 weeks ago';\r\n    case daysPassed <= 21:\r\n      return '3 weeks ago';\r\n    case daysPassed <= 30:\r\n      return '1 month ago';\r\n    case daysPassed <= 60:\r\n      return '2 months ago';\r\n    case daysPassed <= 90:\r\n      return '3 months ago';\r\n    default:\r\n      return new Intl.DateTimeFormat(locale).format(date)\r\n  }\r\n}\r\n\r\nconst preRenderReply = (element, replyingTo, isOnReply) => {\r\n  heights = []\r\n  let inputValue = element.parentElement.previousElementSibling.value.trim()\r\n  inputValue = inputValue.replace(`@${replyingTo}`, \"\");\r\n\r\n  let commentToInsertIn\r\n  console.log(isOnReply)\r\n  if (!isOnReply) {\r\n   commentToInsertIn = commentData.comments.find(comment => comment.user.username === replyingTo)\r\n  } else {\r\n    commentToInsertIn = commentData.comments.find(comment => comment.replies.find(reply => reply.replyingTo == replyingTo))\r\n  }\r\n\r\n  commentToInsertIn.replies.push({\r\n    id: generateUniqueId(),\r\n    content: inputValue.trim(),\r\n    createdAt: formatDate(new Date()),\r\n    score: 0,\r\n    replyingTo: replyingTo,\r\n    user: {\r\n      image: {\r\n        png: \"./images/avatars/image-juliusomo.png\",\r\n        webp: \"./images/avatars/image-juliusomo.webp\",\r\n      },\r\n      username: \"juliusomo\",\r\n    },\r\n  });\r\n\r\n  updatelocalstorage()\r\n  renderComments()\r\n}\r\n\r\nlet replyToUpdate;\r\nlet inputValue;\r\n\r\nconst editReply = (element, commentIndex, replyIndex, score, createdAt, replyingTo) => {\r\n  const comment = commentData.comments.find(comment => comment.id === commentIndex + 1)\r\n  const thisReplies = comment.replies\r\n  const reply = thisReplies.find(reply => thisReplies.indexOf(reply) === replyIndex)\r\n  replyToUpdate = reply\r\n  inputValue = element.parentElement.parentElement.previousElementSibling.textContent.trim().replace(`@${replyingTo}`, \"\")\r\n  const commentCard = element.closest(\".commentCard\")\r\n  const commentSection = element.closest(\".commentSection\")\r\n\r\n  let html = /*html*/ `\r\n  <div class=\"commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 mt-5 ml-auto w-[95%] lg:w-[88%]\">\r\n    ${\r\n      replyIndex === 0\r\n        ? /*html*/ `\r\n    <span id=\"line\" class=\"block line absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300\"></span>\r\n    `\r\n        : \"\"\r\n    }\r\n    <div class=\"commentCard__header flex items-center gap-x-4 pb-4\">\r\n    <img class=\"w-10\" src=\"${currentUser.image.webp}\" alt=\"user profile avatar\">\r\n      <p class=\"username font-semibold\">juliosumo</p>\r\n      <p class=\"you text-white px-2 ml-[-10px] text-sm bg-blue\">you</p>\r\n      <p class=\"postedAt font-medium\">${createdAt}</p>\r\n      </div>\r\n    <textarea oninput=\"validateInput(this)\" name=\"comment\" id=\"update\" cols=\"30\" rows=\"4\" class=\"w-full px-4 py-2 rounded-lg mb-3 lg:mb-0\">@${replyingTo} ${inputValue}</textarea>\r\n    <div class=\"commentCard__footer flex items-center justify-between mt-5 lg:block\">\r\n      <div class=\"score bg-grey flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3\">\r\n        <i class=\"bi bi-plus\"></i>\r\n        <span class=\"count\">${score}</span>\r\n        <i class=\"bi bi-dash\"></i> \r\n      </div>\r\n        <div class=\"updateBtn lg:text-right\">\r\n          <button disabled onclick=\"updateReply(this, '${replyingTo}')\" id=\"updateBtn\" class=\"px-7 py-3 lg:py-2 lg:mt-1 text-white rounded-lg font-medium disabled:opacity-30 disabled:pointer-events-none\">UPDATE</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n </div>\r\n  `\r\n  \r\n  heights = []\r\n  commentCard.remove()\r\n  commentSection.insertAdjacentHTML(\"beforeend\", html)\r\n  commentData.comments.forEach((comment, i) => {\r\n    const { replies } = comment\r\n    if (replies.length > 0) {\r\n      getSpaceBetweenElements(i)\r\n    }\r\n  })\r\n\r\n  const textArea = document.getElementById(\"update\")\r\n  textArea.focus();\r\n  textArea.selectionStart = textArea.value.length + 1;\r\n  textArea.selectionEnd = textArea.value.length + 1;\r\n}\r\n\r\nconst validateInput = (input) => {\r\n  const btn = document.getElementById(\"updateBtn\")\r\n  if (input.value === inputValue) {\r\n    btn.disabled = true;\r\n  } else {\r\n    btn.disabled = false;\r\n  }\r\n} \r\n\r\nconst updateReply = (element, replyingTo) => {\r\n  heights = []\r\n  const inputValue = element.parentElement.parentElement.previousElementSibling.value.trim().replace(`@${replyingTo}`, \"\")\r\n  replyToUpdate.content = inputValue\r\n  replyToUpdate.createdAt = formatDate(new Date())\r\n  updatelocalstorage()\r\n  renderComments()\r\n}\r\n\r\nconst deleteReply = (element, commentIndex, replyIndex, id) => {\r\n  const comment = commentData.comments.find(comment => comment.id === commentIndex + 1)\r\n  let thisReplies = comment.replies\r\n  const index = thisReplies.findIndex(reply => reply.id === id);\r\n  console.log(index)\r\n  if (index === -1) {\r\n    // reply not found\r\n    return;\r\n  }\r\n\r\n  openModal()\r\n\r\n  const deleteBtn = document.getElementById(\"deleteBtn\")\r\n\r\n  deleteBtn.addEventListener(\"click\", () => { \r\n    element.parentElement.parentElement.parentElement.remove()\r\n    thisReplies.splice(index, 1)\r\n    console.log(commentData.comments)\r\n    setTimeout(() => {\r\n      updatelocalstorage()\r\n      renderComments()\r\n    });\r\n    closeModal()\r\n  })\r\n}\r\n\r\n\r\n"]}