"use strict";var modal=document.querySelector(".modal"),overlay=document.querySelector(".overlay"),body=document.querySelector("body"),commentsCtn=document.querySelector(".allCommentCtn"),userImgEl=document.querySelector("#currentUserImg"),openModal=function(e){modal.classList.add("fade-in"),overlay.classList.add("fade-in"),modal.style.display="block",overlay.style.display="block",body.classList.toggle("no-scroll"),overlay.addEventListener("click",closeModal)},closeModal=function(){modal.classList.add("fade-out"),overlay.classList.add("fade-out"),body.classList.toggle("no-scroll"),setTimeout((function(){modal.style.display="none",overlay.style.display="none",modal.classList.remove("fade-out"),overlay.classList.remove("fade-out")}),300)},commentData=JSON.parse(localStorage.getItem("commentData"))||[],currentUser={},updatelocalstorage=function(){localStorage.setItem("commentData",JSON.stringify(commentData)),commentData=JSON.parse(localStorage.getItem("commentData"))},setCurrentUser=function(){currentUser=commentData.currentUser,userImgEl.src=currentUser.image.webp};0===commentData.length?fetch("./data.json").then((function(e){return e.json()})).then((function(e){commentData=e,localStorage.setItem("commentData",JSON.stringify(commentData)),setTimeout((function(){setCurrentUser(),renderComments()}))})).catch((function(e){return console.log("something went wrong",e)})):setTimeout((function(){setCurrentUser(),console.log(commentData.comments),renderComments()}));var renderComments=function(){commentsCtn.innerHTML="",console.log("working"),commentData.comments.forEach((function(e,t){var n=e.content,c=e.createdAt,s=e.replies,o=e.score,l=e.user;l.username!==currentUser.username?commentsCtn.innerHTML+='\n        \n        <section class="commentSection">\n           <div id="'.concat(t,'" class="commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4">\n               <div class="commentCard__header flex items-center gap-x-4 pb-4">\n                   <img class="w-10" src="').concat(l.image.webp,'" alt="profile img avatar">\n                   <p class="username font-semibold">').concat(l.username,'</p>\n                   <p class="postedAt font-medium">').concat(c,'</p>\n               </div>\n               <p class="commentCard__comment">\n                   ').concat(n,'\n               </p>\n               <div class="commentCard__footer flex items-center justify-between mt-5 lg:block">\n                   <div class="score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3">\n                   <i onclick="increaseScore(').concat(t,', this)" class="bi bi-plus"></i>\n                   <span class="count">').concat(o,'</span>\n                   <i onclick="decreaseScore(').concat(t,', this)" class="bi bi-dash"></i>\n                   </div>\n                   <div data-clicked="false" onclick="reply(this, ').concat(t,', false)" class="replyBtn flex items-center gap-x-1 font-medium lg:absolute top-7 right-10 cursor-pointer">\n                   <i class="bi bi-reply-fill"></i>\n                   <p>Reply</p>\n                   </div>\n               </div>\n           </div>\n   \n           ').concat(renderReplies(s,t),"\n   \n      </section>\n   \n        "):commentsCtn.innerHTML+='\n          <section class="commentSection">\n          \n          <div id="'.concat(t,'" class="commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 mt-5 ml-auto w-[95%] lg:w-[88%]">\n              <div class="commentCard__header flex items-center gap-x-4 pb-4">\n                  <img class="w-10" src="').concat(l.image.webp,'" alt="user profile avatar">\n                  <p class="username font-semibold">').concat(l.username,'</p>\n                  <p class="you text-white px-2 ml-[-10px] text-sm">you</p>\n                  <p class="postedAt font-medium">').concat(c,'</p>\n              </div>\n          <p class="commentCard__comment">\n            ').concat(n,'\n          </p>\n          <div class="commentCard__footer flex items-center justify-between mt-5 lg:block">\n          <div class="score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3">\n              <i onclick="increaseScore(').concat(t,', this)" class="bi bi-plus"></i>\n              <span class="count">').concat(o,'</span>\n              <i onclick="decreaseScore(').concat(t,', this)" class="bi bi-dash"></i>\n          </div>\n          <div class="crudBtns flex items-center gap-x-3 lg:gap-x-5 font-medium lg:absolute top-7 right-10">\n              <div onclick="openModal(this)" class="delete flex items-center gap-x-1 text-red-500 cursor-pointer">\n              <i class="bi bi-trash-fill"></i>\n              <p>DELETE</p>\n              </div>\n              <div class="edit flex items-center gap-x-1 cursor-pointer">\n              <i class="bi bi-pen-fill"></i>\n              <p>EDIT</p>\n              </div>\n          </div>\n          </div>\n      </div>\n\n        ').concat(renderReplies(s,t),"\n    </section>\n        ")}))},renderReplies=function(e,t){var n="";return e.length>0&&(getSpaceBetweenElements(t),e.forEach((function(e,c){var s=e.content,o=e.createdAt,l=e.replyingTo,a=e.score,i=e.user;i.username!==currentUser.username?n+='\n            <section class="replySection">\n            \n            <div class="replyCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 w-[95%] lg:w-[88%]">\n                    '.concat(0===c?'\n                    <span id="line" class="block absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300"></span>\n                    ':"",'\n                    <div class="replyCard__header flex items-center gap-x-4 pb-4">\n                        <img class="w-10" src="').concat(i.image.webp,'" alt="">\n                        <p class="username font-semibold">').concat(i.username,'</p>\n                        <p class="postedAt font-medium">').concat(o,'</p>\n                    </div>\n                    <p class="replyCard__comment">\n                     <span class="replyTo font-bold pr-1">@').concat(l,"</span>").concat(s,'\n                    </p>\n                    <div class="replyCard__footer flex items-center justify-between mt-5 lg:block">\n                        <div class="score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3">\n                            <i onclick="increaseReplyScore(').concat(c,", '").concat(t,'\', this)" class="bi bi-plus"></i>\n                            <span class="count">').concat(a,'</span>\n                            <i onclick="decreaseReplyScore(').concat(c,", '").concat(t,'\', this)" class="bi bi-dash"></i>\n                        </div>\n                    <div data-clicked="false" onclick="reply(this, ').concat(t,', true)" class="replyBtn flex items-center gap-x-1 font-medium lg:absolute top-7 right-10 cursor-pointer">\n                        <i class="bi bi-reply-fill"></i>\n                        <p>Reply</p>\n                    </div>\n                  </div>\n           </div>\n\n            </section>\n            '):n+='\n            <div class="commentCard bg-white rounded-xl p-5 relative lg:pr-20 lg:pl-24 lg:pb-4 mt-5 ml-auto w-[95%] lg:w-[88%]">\n            '.concat(0===c?'\n              <span id="line" class="block absolute top-0 w-[2px] left-[-.95rem] lg:left-[-3rem] bg-slate-300"></span>\n              ':"",'\n                <div class="commentCard__header flex items-center gap-x-4 pb-4">\n                    <img class="w-10" src="').concat(i.image.webp,'" alt="user profile avatar">\n                    <p class="username font-semibold">').concat(i.username,'</p>\n                    <p class="you text-white px-2 ml-[-10px] text-sm">you</p>\n                    <p class="postedAt font-medium">').concat(o,'</p>\n                </div>\n                <p class="commentCard__comment">\n                <span class="replyTo font-bold pr-1">@').concat(l,"</span>").concat(s,'\n                </p>\n                <div class="commentCard__footer flex items-center justify-between mt-5 lg:block">\n                <div class="score flex items-center gap-x-3 font-medium rounded-lg px-4 py-2 lg:absolute left-7 lg:flex-col top-5 lg:py-4 lg:px-3">\n                    <i onclick="increaseReplyScore(').concat(c,", '").concat(t,'\', this)" class="bi bi-plus"></i>\n                    <span class="count">').concat(a,'</span>\n                    <i  onclick="decreaseReplyScore(').concat(c,", '").concat(t,'\', this)" class="bi bi-dash"></i>\n                </div>\n                <div class="crudBtns flex items-center gap-x-3 lg:gap-x-5 font-medium lg:absolute top-7 right-10">\n                    <div onclick="openModal(this)" class="delete flex items-center gap-x-1 text-red-500 cursor-pointer">\n                        <i class="bi bi-trash-fill"></i>\n                        <p>DELETE</p>\n                    </div>\n                    <div onclick="edit(this)" class="edit flex items-center gap-x-1 cursor-pointer">\n                        <i class="bi bi-pen-fill"></i>\n                        <p>EDIT</p>\n                    </div>\n                </div>\n                </div>\n          </div>\n            ')}))),n},getSpaceBetweenElements=function(e){var t,n,c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:13;setTimeout((function(){t=document.getElementById("".concat(e)),n=e!==commentData.comments.length-1?t.nextElementSibling:document.querySelector(".addComment"),c=n.offsetTop-(t.offsetTop+t.offsetHeight),document.getElementById("line").style.height="".concat(c-s,"px")}))},increaseScore=function(e,t){var n=commentData.comments.find((function(t){return t.id===e+1}));n.score++,t.nextElementSibling.textContent=n.score,updatelocalstorage()},decreaseScore=function(e,t){var n=commentData.comments.find((function(t){return t.id===e+1}));n.score>0&&n.score--,t.previousElementSibling.textContent=n.score,updatelocalstorage()},increaseReplyScore=function(e,t,n){var c=commentData.comments[t].replies,s=c.find((function(t){return c.indexOf(t)===e}));s.score++,n.nextElementSibling.textContent=s.score,updatelocalstorage()},decreaseReplyScore=function(e,t,n){var c=commentData.comments[t].replies,s=c.find((function(t){return c.indexOf(t)===e}));s.score>0&&s.score--,n.previousElementSibling.textContent=s.score,updatelocalstorage()};window.addEventListener("resize",(function(){commentData.comments.forEach((function(e,t){e.replies.length>0&&getSpaceBetweenElements(t,45)}))}));var reply=function(e,t,n){var c=(n?e.closest(".replySection"):e.closest(".commentSection")).lastElementChild,s=e.getAttribute("data-clicked");"false"==s&&(console.log(s),c.insertAdjacentHTML("afterend",'\n    <div class="addCommentCard bg-white px-5 lg:pr-4 rounded-xl flex flex-col lg:justify-end lg:flex-row gap-x-5 relative lg:pb-6 lg:pt-4 w-[95%] ml-auto lg:w-[88%] mt-5">\n        <textarea name="comment" id="comment" cols="30" rows="2" class="w-full p-4 mt-5 lg:mt-4 rounded-lg lg:w-[70%]" placeholder="Add a comment..."></textarea>\n        <div class="footer flex justify-between items-center lg:block py-3">\n        <img class="w-10 lg:absolute left-5 top-8" src="./images/avatars/image-maxblagun.png" alt="">\n        <button type="button" class="px-7 py-3 lg:py-2 lg:mt-1 text-white rounded-lg font-medium">REPLY</button>\n        </div>\n    </div>\n    '),getSpaceBetweenElements(t,45)),e.setAttribute("data-clicked","true")};